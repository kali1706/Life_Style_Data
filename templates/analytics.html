{% extends "base.html" %}

{% block title %}Analytics - Lifestyle Analytics Platform{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="text-primary mb-1">
                        <i class="fas fa-chart-bar me-2"></i>Analytics Dashboard
                    </h2>
                    <p class="text-muted mb-0">Comprehensive insights into your fitness and nutrition data</p>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-outline-primary" onclick="setTimeRange('7')">7 Days</button>
                    <button type="button" class="btn btn-outline-primary active" onclick="setTimeRange('30')">30 Days</button>
                    <button type="button" class="btn btn-outline-primary" onclick="setTimeRange('90')">90 Days</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Key Metrics Overview -->
    <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card metric-card bg-gradient-primary text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="card-title mb-1 opacity-75">Total Workouts</h6>
                            <h3 class="mb-0" id="totalWorkouts">-</h3>
                            <small class="opacity-75">Last 30 days</small>
                        </div>
                        <div class="metric-icon">
                            <i class="fas fa-dumbbell fa-2x opacity-75"></i>
                        </div>
                    </div>
                    <div class="progress mt-3" style="height: 4px;">
                        <div class="progress-bar bg-white" id="workoutProgress" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card metric-card bg-gradient-success text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="card-title mb-1 opacity-75">Calories Burned</h6>
                            <h3 class="mb-0" id="totalCaloriesBurned">-</h3>
                            <small class="opacity-75">kcal burned</small>
                        </div>
                        <div class="metric-icon">
                            <i class="fas fa-fire fa-2x opacity-75"></i>
                        </div>
                    </div>
                    <div class="progress mt-3" style="height: 4px;">
                        <div class="progress-bar bg-white" id="calorieProgress" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card metric-card bg-gradient-info text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="card-title mb-1 opacity-75">Avg Calories Intake</h6>
                            <h3 class="mb-0" id="avgCaloriesIntake">-</h3>
                            <small class="opacity-75">kcal per day</small>
                        </div>
                        <div class="metric-icon">
                            <i class="fas fa-apple-alt fa-2x opacity-75"></i>
                        </div>
                    </div>
                    <div class="progress mt-3" style="height: 4px;">
                        <div class="progress-bar bg-white" id="intakeProgress" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card metric-card bg-gradient-warning text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="card-title mb-1 opacity-75">Progress Score</h6>
                            <h3 class="mb-0" id="progressScore">-</h3>
                            <small class="opacity-75">out of 100</small>
                        </div>
                        <div class="metric-icon">
                            <i class="fas fa-trophy fa-2x opacity-75"></i>
                        </div>
                    </div>
                    <div class="progress mt-3" style="height: 4px;">
                        <div class="progress-bar bg-white" id="scoreProgress" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Row 1 -->
    <div class="row mb-4">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-line me-2 text-primary"></i>Workout Trends
                    </h5>
                    <div class="btn-group btn-group-sm" role="group">
                        <button type="button" class="btn btn-outline-primary active" onclick="switchWorkoutView('calories')">Calories</button>
                        <button type="button" class="btn btn-outline-primary" onclick="switchWorkoutView('duration')">Duration</button>
                        <button type="button" class="btn btn-outline-primary" onclick="switchWorkoutView('heartrate')">Heart Rate</button>
                    </div>
                </div>
                <div class="card-body">
                    <canvas id="workoutTrendsChart" height="300"></canvas>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-pie me-2 text-primary"></i>Workout Type Distribution
                    </h5>
                </div>
                <div class="card-body">
                    <canvas id="workoutTypeChart" height="300"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Row 2 -->
    <div class="row mb-4">
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-balance-scale me-2 text-primary"></i>Calorie Balance
                    </h5>
                </div>
                <div class="card-body">
                    <canvas id="calorieBalanceChart" height="300"></canvas>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-area me-2 text-primary"></i>Macro Breakdown Trends
                    </h5>
                </div>
                <div class="card-body">
                    <canvas id="macroTrendsChart" height="300"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Row 3 -->
    <div class="row mb-4">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-weight me-2 text-primary"></i>Body Composition Trends
                    </h5>
                </div>
                <div class="card-body">
                    <canvas id="bodyCompositionChart" height="300"></canvas>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-heartbeat me-2 text-primary"></i>Heart Rate Zones
                    </h5>
                </div>
                <div class="card-body">
                    <canvas id="heartRateZoneChart" height="300"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Insights and Recommendations -->
    <div class="row mb-4">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-lightbulb me-2 text-warning"></i>AI-Powered Insights
                    </h5>
                </div>
                <div class="card-body">
                    <div id="insightsContainer">
                        <div class="text-center py-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading insights...</span>
                            </div>
                            <p class="mt-2 text-muted">Analyzing your data...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-target me-2 text-success"></i>Goals Progress
                    </h5>
                </div>
                <div class="card-body">
                    <div class="goal-progress mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="goal-label">Weekly Workouts</span>
                            <span class="goal-value">3/4</span>
                        </div>
                        <div class="progress mb-1" style="height: 8px;">
                            <div class="progress-bar bg-success" style="width: 75%"></div>
                        </div>
                        <small class="text-muted">75% of weekly goal</small>
                    </div>

                    <div class="goal-progress mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="goal-label">Daily Calories</span>
                            <span class="goal-value">1,850/2,000</span>
                        </div>
                        <div class="progress mb-1" style="height: 8px;">
                            <div class="progress-bar bg-info" style="width: 92.5%"></div>
                        </div>
                        <small class="text-muted">92.5% of daily goal</small>
                    </div>

                    <div class="goal-progress mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="goal-label">Water Intake</span>
                            <span class="goal-value">2.1/2.5L</span>
                        </div>
                        <div class="progress mb-1" style="height: 8px;">
                            <div class="progress-bar bg-primary" style="width: 84%"></div>
                        </div>
                        <small class="text-muted">84% of daily goal</small>
                    </div>

                    <div class="goal-progress">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="goal-label">Weight Goal</span>
                            <span class="goal-value">-2.3/-5kg</span>
                        </div>
                        <div class="progress mb-1" style="height: 8px;">
                            <div class="progress-bar bg-warning" style="width: 46%"></div>
                        </div>
                        <small class="text-muted">46% progress</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Detailed Statistics -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-table me-2 text-primary"></i>Detailed Statistics
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="stat-item text-center p-3">
                                <h4 class="text-primary mb-1" id="avgWorkoutDuration">-</h4>
                                <p class="text-muted mb-0">Avg Workout Duration</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-item text-center p-3">
                                <h4 class="text-success mb-1" id="consistencyScore">-</h4>
                                <p class="text-muted mb-0">Consistency Score</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-item text-center p-3">
                                <h4 class="text-info mb-1" id="avgHeartRate">-</h4>
                                <p class="text-muted mb-0">Avg Heart Rate</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-item text-center p-3">
                                <h4 class="text-warning mb-1" id="calorieDeficit">-</h4>
                                <p class="text-muted mb-0">Avg Daily Balance</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let currentTimeRange = 30;
let analyticsData = null;
let charts = {};

document.addEventListener('DOMContentLoaded', function() {
    loadAnalyticsData();
    initializeCharts();
});

function setTimeRange(days) {
    currentTimeRange = parseInt(days);
    
    // Update active button
    document.querySelectorAll('.btn-group button').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    loadAnalyticsData();
}

function loadAnalyticsData() {
    fetch(`/api/analytics_data?days=${currentTimeRange}`)
        .then(response => response.json())
        .then(data => {
            analyticsData = data;
            updateMetrics(data);
            updateCharts(data);
            generateInsights(data);
        })
        .catch(error => {
            console.error('Error loading analytics data:', error);
            showErrorMessage();
        });
}

function updateMetrics(data) {
    document.getElementById('totalWorkouts').textContent = data.total_workouts || 0;
    document.getElementById('totalCaloriesBurned').textContent = (data.total_calories_burned || 0).toLocaleString();
    document.getElementById('avgCaloriesIntake').textContent = Math.round(data.avg_calories_intake || 0);
    document.getElementById('progressScore').textContent = data.progress_score || 0;
    
    // Update progress bars
    document.getElementById('workoutProgress').style.width = Math.min(100, (data.total_workouts / 20) * 100) + '%';
    document.getElementById('calorieProgress').style.width = Math.min(100, (data.total_calories_burned / 10000) * 100) + '%';
    document.getElementById('intakeProgress').style.width = Math.min(100, (data.avg_calories_intake / 2500) * 100) + '%';
    document.getElementById('scoreProgress').style.width = (data.progress_score || 0) + '%';
    
    // Update detailed stats
    document.getElementById('avgWorkoutDuration').textContent = (data.avg_workout_duration || 0).toFixed(1) + 'h';
    document.getElementById('consistencyScore').textContent = (data.consistency_score || 0).toFixed(1) + '%';
    document.getElementById('avgHeartRate').textContent = Math.round(data.avg_heart_rate || 0) + ' bpm';
    document.getElementById('calorieDeficit').textContent = (data.avg_calorie_balance > 0 ? '+' : '') + Math.round(data.avg_calorie_balance || 0) + ' kcal';
}

function initializeCharts() {
    initWorkoutTrendsChart();
    initWorkoutTypeChart();
    initCalorieBalanceChart();
    initMacroTrendsChart();
    initBodyCompositionChart();
    initHeartRateZoneChart();
}

function initWorkoutTrendsChart() {
    const ctx = document.getElementById('workoutTrendsChart');
    if (!ctx) return;

    charts.workoutTrends = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'Calories Burned',
                data: [],
                borderColor: '#007bff',
                backgroundColor: 'rgba(0, 123, 255, 0.1)',
                tension: 0.4,
                fill: true,
                pointBackgroundColor: '#007bff',
                pointBorderColor: '#fff',
                pointBorderWidth: 2,
                pointRadius: 4,
                pointHoverRadius: 6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    titleColor: '#fff',
                    bodyColor: '#fff',
                    cornerRadius: 10
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        color: 'rgba(0,0,0,0.1)',
                        drawBorder: false
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

function initWorkoutTypeChart() {
    const ctx = document.getElementById('workoutTypeChart');
    if (!ctx) return;

    charts.workoutType = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: [],
            datasets: [{
                data: [],
                backgroundColor: [
                    '#007bff', '#28a745', '#dc3545', '#ffc107', '#17a2b8'
                ],
                borderColor: [
                    '#0056b3', '#1e7e34', '#c82333', '#e0a800', '#117a8b'
                ],
                borderWidth: 2,
                hoverOffset: 10
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        usePointStyle: true,
                        padding: 15
                    }
                }
            },
            cutout: '60%'
        }
    });
}

function initCalorieBalanceChart() {
    const ctx = document.getElementById('calorieBalanceChart');
    if (!ctx) return;

    charts.calorieBalance = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [],
            datasets: [{
                label: 'Calorie Balance',
                data: [],
                backgroundColor: function(context) {
                    const value = context.parsed.y;
                    return value >= 0 ? '#28a745' : '#dc3545';
                },
                borderColor: function(context) {
                    const value = context.parsed.y;
                    return value >= 0 ? '#1e7e34' : '#c82333';
                },
                borderWidth: 2,
                borderRadius: 8,
                borderSkipped: false
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    grid: {
                        color: 'rgba(0,0,0,0.1)',
                        drawBorder: false
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

function initMacroTrendsChart() {
    const ctx = document.getElementById('macroTrendsChart');
    if (!ctx) return;

    charts.macroTrends = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'Carbs',
                data: [],
                borderColor: '#ffc107',
                backgroundColor: 'rgba(255, 193, 7, 0.1)',
                tension: 0.4,
                fill: false
            }, {
                label: 'Proteins',
                data: [],
                borderColor: '#28a745',
                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                tension: 0.4,
                fill: false
            }, {
                label: 'Fats',
                data: [],
                borderColor: '#17a2b8',
                backgroundColor: 'rgba(23, 162, 184, 0.1)',
                tension: 0.4,
                fill: false
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        usePointStyle: true,
                        padding: 20
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        color: 'rgba(0,0,0,0.1)',
                        drawBorder: false
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

function initBodyCompositionChart() {
    const ctx = document.getElementById('bodyCompositionChart');
    if (!ctx) return;

    charts.bodyComposition = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'Weight (kg)',
                data: [],
                borderColor: '#28a745',
                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                tension: 0.4,
                fill: true,
                yAxisID: 'y'
            }, {
                label: 'Body Fat %',
                data: [],
                borderColor: '#ffc107',
                backgroundColor: 'rgba(255, 193, 7, 0.1)',
                tension: 0.4,
                fill: false,
                yAxisID: 'y1'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        usePointStyle: true,
                        padding: 20
                    }
                }
            },
            scales: {
                y: {
                    type: 'linear',
                    display: true,
                    position: 'left',
                    grid: {
                        color: 'rgba(0,0,0,0.1)',
                        drawBorder: false
                    }
                },
                y1: {
                    type: 'linear',
                    display: true,
                    position: 'right',
                    grid: {
                        drawOnChartArea: false
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

function initHeartRateZoneChart() {
    const ctx = document.getElementById('heartRateZoneChart');
    if (!ctx) return;

    charts.heartRateZone = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Recovery', 'Aerobic', 'Threshold', 'Maximum', 'Peak'],
            datasets: [{
                label: 'Time in Zone (%)',
                data: [20, 35, 30, 10, 5],
                backgroundColor: 'rgba(0, 123, 255, 0.2)',
                borderColor: '#007bff',
                borderWidth: 2,
                pointBackgroundColor: '#007bff',
                pointBorderColor: '#fff',
                pointBorderWidth: 2,
                pointRadius: 6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                r: {
                    beginAtZero: true,
                    max: 50,
                    grid: {
                        color: 'rgba(0,0,0,0.1)'
                    }
                }
            }
        }
    });
}

function updateCharts(data) {
    // Update workout trends chart
    if (charts.workoutTrends && data.workouts) {
        const dates = data.workouts.map(w => new Date(w.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
        const calories = data.workouts.map(w => w.calories_burned);
        
        charts.workoutTrends.data.labels = dates;
        charts.workoutTrends.data.datasets[0].data = calories;
        charts.workoutTrends.update();
    }

    // Update workout type chart
    if (charts.workoutType && data.workout_types) {
        charts.workoutType.data.labels = Object.keys(data.workout_types);
        charts.workoutType.data.datasets[0].data = Object.values(data.workout_types);
        charts.workoutType.update();
    }

    // Update other charts with similar logic...
}

function switchWorkoutView(view) {
    // Update active button
    document.querySelectorAll('.btn-group-sm button').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');

    if (!analyticsData || !charts.workoutTrends) return;

    let data, label, color;
    switch(view) {
        case 'calories':
            data = analyticsData.workouts.map(w => w.calories_burned);
            label = 'Calories Burned';
            color = '#007bff';
            break;
        case 'duration':
            data = analyticsData.workouts.map(w => w.duration);
            label = 'Duration (hours)';
            color = '#28a745';
            break;
        case 'heartrate':
            data = analyticsData.workouts.map(w => w.avg_bpm);
            label = 'Average Heart Rate';
            color = '#dc3545';
            break;
    }

    charts.workoutTrends.data.datasets[0].data = data;
    charts.workoutTrends.data.datasets[0].label = label;
    charts.workoutTrends.data.datasets[0].borderColor = color;
    charts.workoutTrends.data.datasets[0].pointBackgroundColor = color;
    charts.workoutTrends.update();
}

function generateInsights(data) {
    const container = document.getElementById('insightsContainer');
    
    // Simulate AI insights generation
    setTimeout(() => {
        const insights = [
            {
                type: 'success',
                icon: 'fas fa-thumbs-up',
                title: 'Great Consistency!',
                message: 'You\'ve maintained a consistent workout schedule this month. Keep it up!'
            },
            {
                type: 'warning',
                icon: 'fas fa-exclamation-triangle',
                title: 'Hydration Alert',
                message: 'Your water intake is below recommended levels. Try to drink more water throughout the day.'
            },
            {
                type: 'info',
                icon: 'fas fa-lightbulb',
                title: 'Optimization Tip',
                message: 'Consider adding more protein to your meals to support muscle recovery and growth.'
            },
            {
                type: 'primary',
                icon: 'fas fa-chart-line',
                title: 'Progress Trend',
                message: 'Your calorie burn has increased by 15% compared to last month. Excellent progress!'
            }
        ];

        container.innerHTML = insights.map(insight => `
            <div class="alert alert-${insight.type} border-0 shadow-sm mb-3">
                <div class="d-flex align-items-center">
                    <div class="insight-icon me-3">
                        <i class="${insight.icon} fa-2x"></i>
                    </div>
                    <div>
                        <h6 class="alert-heading mb-1">${insight.title}</h6>
                        <p class="mb-0">${insight.message}</p>
                    </div>
                </div>
            </div>
        `).join('');
    }, 2000);
}

function showErrorMessage() {
    const container = document.getElementById('insightsContainer');
    container.innerHTML = `
        <div class="alert alert-danger text-center">
            <i class="fas fa-exclamation-circle fa-2x mb-2"></i>
            <h6>Unable to load analytics data</h6>
            <p class="mb-0">Please try refreshing the page or contact support if the issue persists.</p>
        </div>
    `;
}
</script>

<style>
.bg-gradient-primary {
    background: linear-gradient(45deg, #007bff, #0056b3);
}

.bg-gradient-success {
    background: linear-gradient(45deg, #28a745, #1e7e34);
}

.bg-gradient-info {
    background: linear-gradient(45deg, #17a2b8, #117a8b);
}

.bg-gradient-warning {
    background: linear-gradient(45deg, #ffc107, #e0a800);
}

.metric-card {
    border: none;
    border-radius: 15px;
    transition: transform 0.3s ease;
}

.metric-card:hover {
    transform: translateY(-5px);
}

.metric-icon {
    opacity: 0.7;
}

.goal-progress {
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 10px;
    border-left: 4px solid #007bff;
}

.goal-label {
    font-weight: 600;
    color: #6c757d;
}

.goal-value {
    font-weight: 700;
    color: #007bff;
}

.stat-item {
    border-right: 1px solid #f0f0f0;
}

.stat-item:last-child {
    border-right: none;
}

.insight-icon {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background-color: rgba(255,255,255,0.2);
}

.card {
    border: none;
    border-radius: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.card-header {
    border-radius: 15px 15px 0 0 !important;
    border-bottom: 1px solid #f0f0f0;
}

.btn-group .btn.active {
    background-color: #007bff;
    color: white;
    border-color: #007bff;
}

.alert {
    border-radius: 10px;
    border: none;
}

@media (max-width: 768px) {
    .metric-card .card-body {
        padding: 1.5rem;
    }
    
    .btn-group {
        flex-direction: column;
    }
    
    .btn-group .btn {
        border-radius: 0.375rem !important;
        margin-bottom: 0.25rem;
    }
}
</style>
{% endblock %}